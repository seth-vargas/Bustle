{% extends "base.html" %}

{% block title %}
{{ user.get_full_name() }}
{% endblock %}

{% block content %}
{% if products.all() | length > 0 %}
<div class="row">
    <h1>Your Cart</h1>
</div>
<div class="row">


    <table class="table table-hover mt-5">
        <thead >
            <tr>
                <th scope="col"></th>
                <th scope="col">Name</th>
                <th scope="col">Price</th>
                <th scope="col">Quantity</th>
                <th scope="col">Total</th>
            </tr>
        </thead>
        <tbody class="table-group-divider">
            {% for product in products %}
            {% with qty = product.get_product_quantity(g.user) %}
            <tr>
                <th scope="row">
                    <span style="cursor: pointer;">
                        <i class="fa-solid fa-xmark me-4 remove-from-table" data-id="{{ product.id }}"data-price="{{ product.price }}"></i>
                    </span>
                </th>
                <td>{{ product.title }}</td>
                <td>{{ "$%.2f" | format(product.price) }}</td>
                <td>{{ qty }}</td>
                <td>{{ "$%.2f" | format(product.price * qty ) }}</td>
            </tr>
            {% endwith %}            
            {% endfor %}              
        </tbody>
    </table>


    <div class="row">
        <h2>Total: <span id="total" data-sum="{{ total }}">{{ "$%.2f" | format(g.user.get_subtotal()) }}</span></h2>
        {% include "checkout.html" %}
    </div>

    {% else %}

    <h1>You have nothing in your cart! <a href="/products">Start shopping</a></h1>

    {% endif %}

</div>
{% endblock %}